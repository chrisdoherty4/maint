blueprint:
  name: "Maint Reset Task (v0.5.3)"
  description: "Reset the last completed date of maintenance tasks."
  domain: automation
  input:
    tag:
      name: "Tag"
      description: "The NFC tag ID to trigger the reset."
      selector:
        text:
    task:
      name: "Task"
      description: "The binary sensor for the target task."
      selector:
        entity:
          domain: binary_sensor
          integration: maint

triggers:
  - trigger: event
    event_type: tag_scanned

conditions:
  - condition: template
    value_template: "{{ trigger.event.data.tag_id == tag }}"

actions:
  - variables:
      tag: !input tag
      task: !input task
  - action: logbook.log
    data_template:
      name: Maint
      message: >
        Resetting {{ task }} beacuse tag {{ tag }} was scanned
  - action: maint.reset_last_completed
    target:
      entity_id: '{{ task }}'
